# ðŸ¥ AI Medical Adapter - MVP

ÐœÐ¸ÐºÑ€Ð¾ÑÐµÑ€Ð²Ð¸Ñ Ð˜Ð˜-ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚Ð° Ð´Ð»Ñ Ð¼ÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÐ¸Ñ… ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ð¹ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ Ð¸ ÐºÐ°Ð·Ð°Ñ…ÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐ°Ñ….

## ðŸ“‹ ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ

**AI Medical Adapter** â€” ÑÑ‚Ð¾ Node.js/TypeScript ÑÐµÑ€Ð²Ð¸Ñ, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ API Ð´Ð»Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ Ñ Ð¼ÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÐ¸Ð¼ Ð˜Ð˜-Ð°ÑÑÐ¸ÑÑ‚ÐµÐ½Ñ‚Ð¾Ð¼. Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð°:

- âœ… Ð’ÐµÐ´Ñ‘Ñ‚ ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¼ÐµÐ´Ð¸Ñ†Ð¸Ð½ÑÐºÐ¸Ð¹ Ð´Ð¸Ð°Ð»Ð¾Ð³ (RU/KZ)
- âœ… Ð¡Ð¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ ÑÐ¸Ð¼Ð¿Ñ‚Ð¾Ð¼Ñ‹, Ð°Ð½Ð°Ð¼Ð½ÐµÐ·, Ð¼Ð¾Ð¶ÐµÑ‚ Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾
- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ "ÐºÑ€Ð°ÑÐ½Ñ‹Ðµ Ñ„Ð»Ð°Ð³Ð¸" Ð¸ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ ÑÑ€Ð¾Ñ‡Ð½ÑƒÑŽ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸
- âœ… ÐŸÑ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð¾Ñ†ÐµÐ½ÐºÑƒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ
- âœ… ÐÐ°Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ðº Ð½ÑƒÐ¶Ð½Ð¾Ð¼Ñƒ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ñƒ
- âœ… ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ñƒ Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€Ñƒ Ð¿Ñ€Ð¸ Ð½ÐµÑƒÐ´Ð¾Ð²Ð»ÐµÑ‚Ð²Ð¾Ñ€Ñ‘Ð½Ð½Ð¾ÑÑ‚Ð¸

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      HTTP      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      OpenAI API      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚  AI Adapter  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚   LLM   â”‚
â”‚             â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  (Express)   â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     JSON        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      Streaming       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   Sessions   â”‚
                                â”‚ (In-Memory)  â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

```
ai-adapter/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ server.ts              # Ð¢Ð¾Ñ‡ÐºÐ° Ð²Ñ…Ð¾Ð´Ð°, Express ÑÐµÑ€Ð²ÐµÑ€
â”‚   â”œâ”€â”€ config.ts              # ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð¸Ð· ENV
â”‚   â”œâ”€â”€ types.ts               # TypeScript Ñ‚Ð¸Ð¿Ñ‹
â”‚   â”œâ”€â”€ llm/
â”‚   â”‚   â”œâ”€â”€ client.ts          # OpenAI-ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ñ‹Ð¹ ÐºÐ»Ð¸ÐµÐ½Ñ‚
â”‚   â”‚   â””â”€â”€ prompts/
â”‚   â”‚       â”œâ”€â”€ system.ts      # Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñ‹ (RU/KZ)
â”‚   â”‚       â”œâ”€â”€ redflags.ts    # ÐšÑ€Ð°ÑÐ½Ñ‹Ðµ Ñ„Ð»Ð°Ð³Ð¸
â”‚   â”‚       â””â”€â”€ routing.ts     # ÐœÐ°Ñ€ÑˆÑ€ÑƒÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ðº ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð°Ð¼
â”‚   â”œâ”€â”€ sessions/
â”‚   â”‚   â””â”€â”€ memoryStore.ts     # Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ ÑÐµÑÑÐ¸Ð¹ (in-memory)
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ json.ts            # Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ JSON (Zod)
â”‚   â”‚   â””â”€â”€ text.ts            # Ð£Ñ‚Ð¸Ð»Ð¸Ñ‚Ñ‹ Ð´Ð»Ñ Ñ‚ÐµÐºÑÑ‚Ð°
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ routes.ts          # API Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ñ‹
â”œâ”€â”€ test/
â”‚   â”œâ”€â”€ e2e.http               # E2E Ñ‚ÐµÑÑ‚Ñ‹ (REST Client)
â”‚   â””â”€â”€ cases/                 # Ð¢ÐµÑÑ‚-ÐºÐµÐ¹ÑÑ‹ Ð² JSON
â”œâ”€â”€ .env.example               # ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

## ðŸš€ Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚

### 1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹

```bash
npm install
```

### 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» `.env` Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ `.env.example`:

```bash
cp .env.example .env
```

ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ `.env`:

```env
# OpenAI-ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ñ‹Ð¹ API
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini

# Ð¡ÐµÑ€Ð²ÐµÑ€
PORT=3001

# ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
RESPONSE_TIMEOUT_MS=15000
MAX_HISTORY_TOKENS=8000
LANG_DEFAULT=ru
```

### 3. Ð—Ð°Ð¿ÑƒÑÐº Ð² Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸

```bash
npm run dev
```

Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑÑ Ð½Ð° `http://localhost:3001`

### 4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ð¾ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾ÑÑ‚Ð¸

```bash
curl http://localhost:3001/health
```

ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ð¾Ñ‚Ð²ÐµÑ‚:
```json
{
  "status": "ok",
  "timestamp": "2025-11-04T12:00:00.000Z",
  "sessions": 0
}
```

## ðŸ“¡ API Endpoints

### `POST /ai/message` - Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

#### Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÐµÑÑÐ¸Ð¸

```json
{
  "sessionId": "unique-session-id",
  "type": "init",
  "fio": "Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²Ð¸Ñ‡",
  "lang": "ru"
}
```

**ÐžÑ‚Ð²ÐµÑ‚:**
```json
{
  "reply": "Ð”Ð¾Ð±Ñ€Ð¾Ð³Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ ÑÑƒÑ‚Ð¾Ðº, Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²Ð¸Ñ‡! Ð§ÐµÐ¼ Ð¼Ð¾Ð³Ñƒ Ð²Ð°Ð¼ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ?"
}
```

#### ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ

```json
{
  "sessionId": "unique-session-id",
  "type": "message",
  "message": "Ð£ Ð¼ÐµÐ½Ñ Ð±Ð¾Ð»Ð¸Ñ‚ Ð³Ð¾Ñ€Ð»Ð¾ Ð¸ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ð° 38",
  "imageUrl": "https://example.com/photo.jpg"  // Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾
}
```

**ÐžÑ‚Ð²ÐµÑ‚:**
```json
{
  "reply": "ÐŸÐ¾Ð½ÑÐ», Ð´Ð°Ð²Ð°Ð¹Ñ‚Ðµ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ð¼ Ð´ÐµÑ‚Ð°Ð»Ð¸. ÐšÐ°Ðº Ð´Ð°Ð²Ð½Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð¾ÑÑŒ?...\n\nÐ’Ð°Ð¶Ð½Ð¾: ÑÑ‚Ð¾ Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ..."
}
```

### `POST /ai/finalize` - Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ð¸

#### ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÐÐ• Ð´Ð¾Ð²Ð¾Ð»ÐµÐ½

```json
{
  "sessionId": "unique-session-id",
  "satisfaction": "no"
}
```

**ÐžÑ‚Ð²ÐµÑ‚:**
```json
{
  "intent": "handoff_to_operator",
  "reason": "ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½ÐµÐ´Ð¾Ð²Ð¾Ð»ÐµÐ½ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð¼"
}
```

#### ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð´Ð¾Ð²Ð¾Ð»ÐµÐ½

```json
{
  "sessionId": "unique-session-id",
  "satisfaction": "yes"
}
```

**ÐžÑ‚Ð²ÐµÑ‚:**
```json
{
  "intent": "make_referral",
  "fio": "Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²Ð¸Ñ‡",
  "preliminary_assessment": "ÐžÐ Ð’Ð˜ Ð±ÐµÐ· Ð¿Ñ€Ð¸Ð·Ð½Ð°ÐºÐ¾Ð² Ð¾ÑÐ»Ð¾Ð¶Ð½ÐµÐ½Ð¸Ñ (Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾)",
  "doctor_type": "Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚"
}
```

### `GET /health` - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð´Ð¾Ñ€Ð¾Ð²ÑŒÑ ÑÐµÑ€Ð²Ð¸ÑÐ°

```json
{
  "status": "ok",
  "timestamp": "2025-11-04T12:00:00.000Z",
  "sessions": 5
}
```

## ðŸ©º Ð¢Ð¸Ð¿Ñ‹ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð¾Ð²

Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ðº ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¼ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸ÑÑ‚Ð°Ð¼:

- `Ñ‚ÐµÑ€Ð°Ð¿ÐµÐ²Ñ‚` - Ð¾Ð±Ñ‰Ð¸Ðµ ÑÐ¸Ð¼Ð¿Ñ‚Ð¾Ð¼Ñ‹, Ð¿Ñ€Ð¾ÑÑ‚ÑƒÐ´Ð°
- `Ð›ÐžÐ ` - Ð³Ð¾Ñ€Ð»Ð¾, ÑƒÑˆÐ¸, Ð½Ð¾Ñ
- `Ð´ÐµÑ€Ð¼Ð°Ñ‚Ð¾Ð»Ð¾Ð³` - ÐºÐ¾Ð¶Ð°, Ð½Ð¾Ð³Ñ‚Ð¸, Ð²Ð¾Ð»Ð¾ÑÑ‹
- `Ð¾Ñ„Ñ‚Ð°Ð»ÑŒÐ¼Ð¾Ð»Ð¾Ð³` - Ð³Ð»Ð°Ð·Ð°
- `Ð½ÐµÐ²Ñ€Ð¾Ð»Ð¾Ð³` - Ð½ÐµÐ²Ñ€Ð¾Ð»Ð¾Ð³Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÑÐ¸Ð¼Ð¿Ñ‚Ð¾Ð¼Ñ‹
- `ÐºÐ°Ñ€Ð´Ð¸Ð¾Ð»Ð¾Ð³` - ÑÐµÑ€Ð´Ñ†Ðµ, Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ
- `Ñ…Ð¸Ñ€ÑƒÑ€Ð³` / `Ñ‚Ñ€Ð°Ð²Ð¼Ð°Ñ‚Ð¾Ð»Ð¾Ð³` - Ñ‚Ñ€Ð°Ð²Ð¼Ñ‹, Ñ€Ð°Ð½Ñ‹
- `ÑÐ½Ð´Ð¾ÐºÑ€Ð¸Ð½Ð¾Ð»Ð¾Ð³` - Ð³Ð¾Ñ€Ð¼Ð¾Ð½Ñ‹, Ð´Ð¸Ð°Ð±ÐµÑ‚
- `Ð³Ð¸Ð½ÐµÐºÐ¾Ð»Ð¾Ð³` / `ÑƒÑ€Ð¾Ð»Ð¾Ð³` - ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹
- `Ð³Ð°ÑÑ‚Ñ€Ð¾ÑÐ½Ñ‚ÐµÑ€Ð¾Ð»Ð¾Ð³` - Ð–ÐšÐ¢
- `Ð¿ÐµÐ´Ð¸Ð°Ñ‚Ñ€` - Ð´ÐµÑ‚Ð¸

## ðŸš¨ ÐšÑ€Ð°ÑÐ½Ñ‹Ðµ Ñ„Ð»Ð°Ð³Ð¸

Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ñ‘Ñ‚ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¸ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ ÑÑ€Ð¾Ñ‡Ð½ÑƒÑŽ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒ:

- Ð‘Ð¾Ð»ÑŒ Ð² Ð³Ñ€ÑƒÐ´Ð¸, Ð¾Ð´Ñ‹ÑˆÐºÐ°
- ÐŸÐ¾Ñ‚ÐµÑ€Ñ ÑÐ¾Ð·Ð½Ð°Ð½Ð¸Ñ, ÑÑƒÐ´Ð¾Ñ€Ð¾Ð³Ð¸
- ÐšÑ€Ð¾Ð²Ð°Ð²Ð°Ñ Ñ€Ð²Ð¾Ñ‚Ð°
- Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ð° Ñƒ Ð¼Ð»Ð°Ð´ÐµÐ½Ñ†ÐµÐ²
- ÐÐ»Ð»ÐµÑ€Ð³Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ€ÐµÐ°ÐºÑ†Ð¸Ð¸
- Ð¢Ñ€Ð°Ð²Ð¼Ñ‹ Ð³Ð¾Ð»Ð¾Ð²Ñ‹
- Ð˜ Ð´Ñ€ÑƒÐ³Ð¸Ðµ...

## ðŸ§ª Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ REST Client (VSCode)

1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ [REST Client](https://marketplace.visualstudio.com/items?itemName=humao.rest-client)
2. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ `test/e2e.http`
3. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ "Send Request" Ð½Ð°Ð´ Ð½ÑƒÐ¶Ð½Ñ‹Ð¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð¼

### Ð¡ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ curl

```bash
# Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
curl -X POST http://localhost:3001/ai/message \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId": "test-001",
    "type": "init",
    "fio": "Ð¢ÐµÑÑ‚Ð¾Ð² Ð¢ÐµÑÑ‚",
    "lang": "ru"
  }'

# Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ
curl -X POST http://localhost:3001/ai/message \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId": "test-001",
    "type": "message",
    "message": "Ð‘Ð¾Ð»Ð¸Ñ‚ Ð³Ð¾Ð»Ð¾Ð²Ð°"
  }'

# Ð¤Ð¸Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
curl -X POST http://localhost:3001/ai/finalize \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId": "test-001",
    "satisfaction": "yes"
  }'
```

## ðŸ”§ ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ

### ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

| ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ | ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ |
|-----------|----------|--------------|
| `OPENAI_API_KEY` | API ÐºÐ»ÑŽÑ‡ Ð´Ð»Ñ LLM | - |
| `OPENAI_BASE_URL` | Base URL API | `https://api.openai.com/v1` |
| `OPENAI_MODEL` | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ | `gpt-4o-mini` |
| `PORT` | ÐŸÐ¾Ñ€Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð° | `3001` |
| `RESPONSE_TIMEOUT_MS` | Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð¾Ñ‚Ð²ÐµÑ‚Ð° LLM | `15000` |
| `MAX_HISTORY_TOKENS` | Ð›Ð¸Ð¼Ð¸Ñ‚ Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð² Ð¸ÑÑ‚Ð¾Ñ€Ð¸Ð¸ | `8000` |
| `LANG_DEFAULT` | Ð¯Ð·Ñ‹Ðº Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ | `ru` |

### Ð¡Ð¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ñ‹Ðµ LLM Ð¿Ñ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€Ñ‹

Ð›ÑŽÐ±Ð¾Ð¹ OpenAI-ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ñ‹Ð¹ API:
- OpenAI GPT-4/GPT-3.5
- Azure OpenAI
- Anthropic Claude (Ñ‡ÐµÑ€ÐµÐ· Ð¿Ñ€Ð¾ÐºÑÐ¸)
- Local models (Ollama, LM Studio)
- Ð˜ Ð´Ñ€ÑƒÐ³Ð¸Ðµ...

## ðŸ“ ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸

### JavaScript/TypeScript

```typescript
const sessionId = crypto.randomUUID();

// Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
const initRes = await fetch('http://localhost:3001/ai/message', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    sessionId,
    type: 'init',
    fio: 'Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½',
    lang: 'ru'
  })
});

// Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ
const msgRes = await fetch('http://localhost:3001/ai/message', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    sessionId,
    type: 'message',
    message: 'Ð‘Ð¾Ð»Ð¸Ñ‚ Ð³Ð¾Ñ€Ð»Ð¾'
  })
});

// Ð¤Ð¸Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
const finalRes = await fetch('http://localhost:3001/ai/finalize', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    sessionId,
    satisfaction: 'yes'
  })
});

const referral = await finalRes.json();
console.log(referral); // { intent: "make_referral", ... }
```

### Python

```python
import requests
import uuid

session_id = str(uuid.uuid4())
base_url = "http://localhost:3001"

# Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
init_response = requests.post(f"{base_url}/ai/message", json={
    "sessionId": session_id,
    "type": "init",
    "fio": "Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½",
    "lang": "ru"
})

# Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ
msg_response = requests.post(f"{base_url}/ai/message", json={
    "sessionId": session_id,
    "type": "message",
    "message": "Ð‘Ð¾Ð»Ð¸Ñ‚ Ð³Ð¾Ñ€Ð»Ð¾"
})

# Ð¤Ð¸Ð½Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
final_response = requests.post(f"{base_url}/ai/finalize", json={
    "sessionId": session_id,
    "satisfaction": "yes"
})

referral = final_response.json()
print(referral)
```

## ðŸ”’ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð¸ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾

### Ð”Ð»Ñ production Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ:

1. **ÐÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ**: Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ JWT/API keys
2. **Rate limiting**: ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²
3. **Persistent storage**: Redis Ð´Ð»Ñ ÑÐµÑÑÐ¸Ð¹
4. **Logging**: Winston/Pino Ð´Ð»Ñ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
5. **Monitoring**: Prometheus/Grafana
6. **HTTPS**: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ SSL/TLS
7. **Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ**: Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
8. **Content moderation**: Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½ÐµÐ¿Ñ€Ð¸ÐµÐ¼Ð»ÐµÐ¼Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°

## ðŸ“Š ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³

Ð›Ð¾Ð³Ð¸ Ð²Ñ‹Ð²Ð¾Ð´ÑÑ‚ÑÑ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ñ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑÐ°Ð¼Ð¸:
- `âœ…` - Ð£ÑÐ¿ÐµÑˆÐ½Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ
- `âŒ` - ÐžÑˆÐ¸Ð±ÐºÐ°
- `âš ï¸` - ÐŸÑ€ÐµÐ´ÑƒÐ¿Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ðµ
- `ðŸ“¥` - Ð’Ñ…Ð¾Ð´ÑÑ‰Ð¸Ð¹ Ð·Ð°Ð¿Ñ€Ð¾Ñ

ÐŸÑ€Ð¸Ð¼ÐµÑ€:
```
ðŸ“¥ POST /ai/message
âœ… Session test-001 initialized for Ð˜Ð²Ð°Ð½Ð¾Ð² Ð˜Ð²Ð°Ð½ (ru)
âœ… Message processed for session test-001
```

## ðŸ¤ Ð’ÐºÐ»Ð°Ð´ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚

Contributions are welcome! Please:

1. Fork Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹
2. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ (`git commit -m 'Add amazing feature'`)
4. Push Ð² branch (`git push origin feature/amazing-feature`)
5. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Pull Request

## ðŸ“„ Ð›Ð¸Ñ†ÐµÐ½Ð·Ð¸Ñ

ISC License

## ðŸ”— Ð¡ÑÑ‹Ð»ÐºÐ¸

- GitHub: https://github.com/ukudarovv/medicine_project
- Issues: https://github.com/ukudarovv/medicine_project/issues

## ðŸ“ž ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°

ÐŸÑ€Ð¸ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ½Ð¾Ð²ÐµÐ½Ð¸Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼:
1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ `.env` Ñ„Ð°Ð¹Ð»
2. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ LLM API Ð´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½
3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸
4. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ issue Ð½Ð° GitHub

---

**Ð’Ð°Ð¶Ð½Ð¾**: Ð­Ñ‚Ð¾ MVP Ð²ÐµÑ€ÑÐ¸Ñ Ð´Ð»Ñ Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸. ÐÐµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð² production Ð±ÐµÐ· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¼ÐµÑ€ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸ Ð¸ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ.

